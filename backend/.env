# backend/.env - Enhanced Security Configuration for Phase 2

# Basic Configuration
NODE_ENV=development
PORT=3000
MONGODB_URI=mongodb://localhost:27017/exchange
REDIS_URL=redis://localhost:6379
FRONTEND_URL=http://localhost:5173

# JWT Configuration - Enhanced with separate secrets
JWT_SECRET=your-super-secure-jwt-secret-key-min-32-chars
JWT_ACCESS_SECRET=access-token-secret-key-must-be-different-and-very-secure-2024
JWT_REFRESH_SECRET=refresh-token-secret-key-must-be-unique-and-very-secure-2024
SESSION_SECRET=your-super-secure-session-secret-key-min-32-chars

# Encryption Keys for AES-256 (Base64 encoded 32-byte keys)
ENCRYPTION_KEY=dGVzdC1lbmNyeXB0aW9uLWtleS0zMi1ieXRlcy1sb25n
ENCRYPTION_KEY_PERSONAL=cGVyc29uYWwtZGF0YS1lbmNyeXB0aW9uLWtleS0zMmJ5dGVz
ENCRYPTION_KEY_FINANCIAL=ZmluYW5jaWFsLWRhdGEtZW5jcnlwdGlvbi1rZXktMzJieXRlcw==
ENCRYPTION_KEY_API=YXBpLWtleXMtZW5jcnlwdGlvbi1rZXktMzItYnl0ZXMtbG9uZw==

# Enhanced Security Settings
ENFORCE_2FA_FOR_ADMINS=true
ALLOWED_ORIGINS=http://localhost:3000,http://localhost:5173,https://yourdomain.com
API_VERSION=3.0.0

# Advanced Rate Limiting Configuration
RATE_LIMIT_WINDOW_MS=60000
RATE_LIMIT_MAX_REQUESTS=100
SESSION_TIMEOUT_MS=1800000

# 2FA Settings
TWO_FA_WINDOW_SECONDS=30
TWO_FA_BACKUP_CODES_COUNT=8

# IP Security
MAX_FAILED_ATTEMPTS=5
LOCKOUT_TIME_MS=900000
IP_WHITELIST_ENABLED=false

# Audit & Logging
AUDIT_LOG_RETENTION_DAYS=365
SECURITY_LOG_LEVEL=info

# Enhanced Rate Limiting Rules (JSON format)
RATE_LIMITS='{"auth":{"requests":5,"window":900000},"api":{"requests":100,"window":60000},"admin":{"requests":500,"window":60000},"transaction":{"requests":50,"window":3600000},"2fa":{"requests":10,"window":300000}}'

# Blocked/Allowed Countries (comma separated ISO codes)
BLOCKED_COUNTRIES=CN,RU,KP
ALLOWED_COUNTRIES=

# Email Configuration (for security alerts)
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=your-email@gmail.com
SMTP_PASS=your-app-password
SECURITY_ALERT_EMAIL=security@yourcompany.com

# File Upload Security
MAX_FILE_SIZE=10485760
ALLOWED_MIME_TYPES=image/jpeg,image/png,application/pdf

# Digital Signature
RSA_KEY_SIZE=2048
SIGNATURE_ALGORITHM=RS256
